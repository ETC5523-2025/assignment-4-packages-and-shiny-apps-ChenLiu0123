season_stats <- seasons %>%
count(season, name = "count") %>%
mutate(
proportion = count / sum(count),
percentage = percent(proportion, accuracy = 0.1)  # 保留1位小数
) %>%
arrange(desc(count))
season_data <- tibble(date = cwr_tidy&date) %>%
mutate(
season = case_when(
month(date) %in% 3:5 ~ "Spring",
month(date) %in% 6:8 ~ "Summer",
month(date) %in% 9:11 ~ "Autumn",
TRUE ~ "Winter"  # 默认12月、1月、2月为冬季
)
)
season_data <- tibble(date = c(cwr_tidy&date)) %>%
mutate(
season = case_when(
month(date) %in% 3:5 ~ "Spring",
month(date) %in% 6:8 ~ "Summer",
month(date) %in% 9:11 ~ "Autumn",
TRUE ~ "Winter"  # 默认12月、1月、2月为冬季
)
)
count_table <- table(seaons)
count_table <- table(seasons)
count_table <- table(seasons)
prop_table <- prop.table(seasons) * 100
count_table <- table(seasons)
prop_table <- prop.table(count_table) * 100
result <- data.frame(
Item = names(count_table),
Count = as.numeric(count_table),
Percentage = paste0(round(prop_table, 1), "%")
)
print(result)
install.packages("rmarkdown")
time_diff <- difftime(cwr_tidy&end_time, cwr_tidy&begin_time, units = "hours")
cwr_tidy&end_time
cwr_tidy&date
time_diff <- difftime(cwr_tidy$end_time, cwr_tidy$begin_time, units = "hours")
time_diff <- difftime(c(cwr_tidy$end_time), c(cwr_tidy$begin_time), units = "hours")
print(time_diff)
count_table <- table(cwr_tidy$location)
> prop_table <- prop.table(count_table) * 100
count_table <- table(cwr_tidy$location)
prop_table <- prop.table(count_table) * 100
result <- data.frame(
Item = names(count_table),
Count = as.numeric(count_table),
Percentage = paste0(round(prop_table, 1), "%")
)
result
View(result)
word_counts <- tibble(text = c(cwr_tidy$encounter_summary)) %>%
unnest_tokens(word, text) %>%          # 分词
anti_join(stop_words) %>%             # 移除停用词(the, is等)
count(word, sort = TRUE) %>%         # 统计词频
filter(nchar(word) > 2)
library(tidytext)
install.packages("tidytext")
word_counts <- tibble(text = c(cwr_tidy$encounter_summary)) %>%
unnest_tokens(word, text) %>%          # 分词
anti_join(stop_words) %>%             # 移除停用词(the, is等)
count(word, sort = TRUE) %>%         # 统计词频
filter(nchar(word) > 2)
library(tidytext)
word_counts <- tibble(text = c(cwr_tidy$encounter_summary)) %>%
unnest_tokens(word, text) %>%          # 分词
anti_join(stop_words) %>%             # 移除停用词(the, is等)
count(word, sort = TRUE) %>%         # 统计词频
filter(nchar(word) > 2)
word_counts %>%
slice_max(n, n = 10) %>%
ggplot(aes(x = reorder(word, n), y = n)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(title = "Top 10 Frequent Words", x = "Word", y = "Count")
library(ggplot2)
install.packages("ggplot2")
word_counts %>%
slice_max(n, n = 10) %>%
ggplot(aes(x = reorder(word, n), y = n)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(title = "Top 10 Frequent Words", x = "Word", y = "Count")
library(ggplot2)
word_counts %>%
slice_max(n, n = 10) %>%
ggplot(aes(x = reorder(word, n), y = n)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(title = "Top 10 Frequent Words", x = "Word", y = "Count")
View(tuesdata)
View(cwr_tidy)
install.packages("openxlsx")
library(openxlsx)
write.xlsx(cwr_tidy, "output.xlsx")
library(orcas)
data("cwr_tidy",package='orcas')
orcas<-cwr_tidy
library(lubridate)
library(dplyr)
get_season <- function(dates) {
month_num <- month(dates) # 提取月份
case_when(
month_num %in% 3:5 ~ "Spring",
month_num %in% 6:8 ~ "Summer",
month_num %in% 9:11 ~ "Autumn",
month_num %in% c(12,1,2) ~ "Winter",
TRUE ~ NA_character_
)
}
load("C:/Users/yangjun1-jk/AppData/Local/Temp/Rar$DIa30248.13837/.RData")
library(orcas)
library(lubridate)
library(dplyr)
library(tidytext)
library(ggplot2)
data("cwr_tidy",package='orcas')
orcas<-cwr_tidy
get_season <- function(dates) {
month_num <- month(dates) # 提取月份
case_when(
month_num %in% 3:5 ~ "Spring",
month_num %in% 6:8 ~ "Summer",
month_num %in% 9:11 ~ "Autumn",
month_num %in% c(12,1,2) ~ "Winter",
TRUE ~ NA_character_
) }
seasons=get_season(dates)
seasons=get_season(cwr_tidy$date)
count_table <- table(seasons)
prop_table <- prop.table(count_table) * 100
result <- data.frame(
Item = names(count_table),
Count = as.numeric(count_table),
Percentage = paste0(round(prop_table, 1), "%")
)
print(result)
count_table1 <- table(cwr_tidy$location)
prop_table1 <- prop.table(count_table1) * 100
result1 <- data.frame(
Item = names(count_table1),
Count = as.numeric(count_table1),
Percentage = paste0(round(prop_table1, 1), "%")
)
print(result1)
View(result1)
View(result1)
result1[order(result1$Count,decreasing = TRUE), ]
count_table1 <- table(cwr_tidy$location)
prop_table1 <- prop.table(count_table1) * 100
result1 <- data.frame(
Item = names(count_table1),
Count = as.numeric(count_table1),
Percentage = paste0(round(prop_table1, 1), "%")
)
result1=result1[order(result1$Count,decreasing = TRUE), ]
print(result1)
View(result1)
View(result1)
View(cwr_tidy)
View(cwr_tidy)
count_table_observers <- table(cwr_tidy$observers)
prop_table_observers <- prop.table(count_table_observers) * 100
result_observers <- data.frame(
Item = names(count_table_observers),
Count = as.numeric(count_table_observers),
Percentage = paste0(round(prop_table_observers, 1), "%")
)
result_observers=result_observers[order(result_observers$Count,decreasing = TRUE), ]
print(result_observers)
View(result_observers)
View(result_observers)
count_table_vessel <- table(cwr_tidy$vessel)
prop_table_vessel <- prop.table(count_table_vessel) * 100
result_vessel <- data.frame(
Item = names(count_table_vessel),
Count = as.numeric(count_table_vessel),
Percentage = paste0(round(prop_table_vessel, 1), "%")
)
result_vessel=result_vessel[order(result_vessel$Count,decreasing = TRUE), ]
print(result_vessel)
View(result_vessel)
View(result_vessel)
View(result_observers)
View(result_observers)
duration1=difftime(c(cwr_tidy$end_time), c(cwr_tidy$begin_time), units = "hours")
library("tidytuesdayR")
cwr_tidy <- tidytuesdayR::tt_load(2024, week = 42)
cwr_tidy <- tidytuesdayR::tt_load(2024, week = 42)
tuesdata <- tidytuesdayR::tt_load('2024-10-15')
c(cwr_tidy$end_time)-c(cwr_tidy$begin_time)
duration1=cwr_tidy$end_time-cwr_tidy$begin_time
duration1
duration1=c(cwr_tidy$end_time-cwr_tidy$begin_time)
duration1
duration1 <- duration1[duration1 >= 0 & !is.na(duration1)]
duration1 <- duration1[duration1 >= 0 & !is.na(duration1)]
duration1
ggplot(duration1,aes(duration1))+
geom_density()
duration1=data.frame(duration1)
View(duration1)
View(duration1)
View(duration1)
View(duration1)
ggplot(duration1,aes(duration1))+
geom_density()
filtered_df <- cwr_tidy[cwr_tidy$duration > 10000 & !is.na(cwr_tidy$duration), ]
View(filtered_df)
View(filtered_df)
cwr_tidy$duration1=cwr_tidy$end_time-cwr_tidy$begin_time
View(cwr_tidy)
View(cwr_tidy)
filtered_df <- cwr_tidy[cwr_tidy$duration1 > 10000 & !is.na(cwr_tidy$duration1), ]
View(filtered_df)
View(filtered_df)
count_table_long_vessel <- table(filtered_df$vessel)
prop_table_long_vessel <- prop.table(count_table_long_vessel) * 100
result_long_vessel <- data.frame(
Item = names(count_table_long_vessel),
Count = as.numeric(count_table_long_vessel),
Percentage = paste0(round(prop_table_long_vessel, 1), "%")
)
result_long_vessel=result_long_vessel[order(result_long_vessel$Count,decreasing = TRUE), ]
print(result_long_vessel)
View(result_long_vessel)
View(result_long_vessel)
View(filtered_df)
filtered_df1 <- cwr_tidy[cwr_tidy$encounter_sequence !=1 & !is.na(cwr_tidy$encounter_sequence), ]
count_table_multi_vessel <- table(filtered_df1$vessel)
prop_table_multi_vessel <- prop.table(count_table_multi_vessel) * 100
result_multi_vessel <- data.frame(
Item = names(count_table_multi_vessel),
Count = as.numeric(count_table_multi_vessel),
Percentage = paste0(round(prop_table_multi_vessel, 1), "%")
)
result_multi_vessel=result_multi_vessel[order(result_multi_vessel$Count,decreasing = TRUE), ]
print(result_multi_vessel)
View(result_multi_vessel)
View(result_multi_vessel)
word_counts <- tibble(text = cwr_tidy$encounter_summary) %>%
unnest_tokens(word, text) %>%
anti_join(stop_words) %>%
count(word, sort = TRUE) %>%
filter(nchar(word) > 2)
View(word_counts)
View(word_counts)
word_counts %>%
slice_max(n, n = 10) %>%
ggplot(aes(x = reorder(word, n), y = n)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(title = "Top 10 Frequent Words", x = "Word", y = "Count")
View(word_counts)
View(word_counts)
ggplot(duration1,aes(duration1))+
geom_density()
quantile(duration1)
quantile(duration1$duration1)
knitr::opts_chunk$set(echo = TRUE,message = F,warning = F)
# Load the packages.
library(orcas)
library(lubridate)
library(dplyr)
library(tidytext)
library(ggplot2)
data("cwr_tidy",package='orcas')
orcas<-cwr_tidy
get_season <- function(dates) {
month_num <- month(dates) # 提取月份
case_when(
month_num %in% 3:5 ~ "Spring",
month_num %in% 6:8 ~ "Summer",
month_num %in% 9:11 ~ "Autumn",
month_num %in% c(12,1,2) ~ "Winter",
TRUE ~ NA_character_
) }
seasons=get_season(dates)
get_season <- function(dates) {
month_num <- month(dates) # 提取月份
case_when(
month_num %in% 3:5 ~ "Spring",
month_num %in% 6:8 ~ "Summer",
month_num %in% 9:11 ~ "Autumn",
month_num %in% c(12,1,2) ~ "Winter",
TRUE ~ NA_character_
) }
seasons=get_season(cwr_tidy$date)
count_table <- table(seasons)
prop_table <- prop.table(count_table) * 100
result <- data.frame(
Item = names(count_table),
Count = as.numeric(count_table),
Percentage = paste0(round(prop_table, 1), "%")
)
print(result)
View(cwr_tidy)
View(cwr_tidy)
head(cwr_tidy$date)
duration1=c(cwr_tidy$end_time-cwr_tidy$begin_time)
duration1 <- duration1[duration1 >= 0 & !is.na(duration1)]
duration1=data.frame(duration1)
ggplot(duration1,aes(duration1))+
geom_density()
quantile(duration1$duration1)
count_table1 <- table(cwr_tidy$location)
prop_table1 <- prop.table(count_table1) * 100
result1 <- data.frame(
Item = names(count_table1),
Count = as.numeric(count_table1),
Percentage = paste0(round(prop_table1, 1), "%")
)
result1=result1[order(result1$Count,decreasing = TRUE), ]
print(result1)
count_table_observers <- table(cwr_tidy$observers)
prop_table_observers <- prop.table(count_table_observers) * 100
result_observers <- data.frame(
Item = names(count_table_observers),
Count = as.numeric(count_table_observers),
Percentage = paste0(round(prop_table_observers, 1), "%")
)
result_observers=result_observers[order(result_observers$Count,decreasing = TRUE), ]
print(result_observers)
count_table_vessel <- table(cwr_tidy$vessel)
prop_table_vessel <- prop.table(count_table_vessel) * 100
result_vessel <- data.frame(
Item = names(count_table_vessel),
Count = as.numeric(count_table_vessel),
Percentage = paste0(round(prop_table_vessel, 1), "%")
)
result_vessel=result_vessel[order(result_vessel$Count,decreasing = TRUE), ]
print(result_vessel)
duration1=c(cwr_tidy$end_time-cwr_tidy$begin_time)
duration1 <- duration1[duration1 >= 0 & !is.na(duration1)]
duration1=data.frame(duration1)
ggplot(duration1,aes(duration1))+
geom_density()
cwr_tidy$duration1=cwr_tidy$end_time-cwr_tidy$begin_time
filtered_df <- cwr_tidy[cwr_tidy$duration1 > 10000 & !is.na(cwr_tidy$duration1), ]
count_table_long_vessel <- table(filtered_df$vessel)
prop_table_long_vessel <- prop.table(count_table_long_vessel) * 100
result_long_vessel <- data.frame(
Item = names(count_table_long_vessel),
Count = as.numeric(count_table_long_vessel),
Percentage = paste0(round(prop_table_long_vessel, 1), "%")
)
result_long_vessel=result_long_vessel[order(result_long_vessel$Count,decreasing = TRUE), ]
print(result_long_vessel)
filtered_df1 <- cwr_tidy[cwr_tidy$encounter_sequence !=1 & !is.na(cwr_tidy$encounter_sequence), ]
count_table_multi_vessel <- table(filtered_df1$vessel)
prop_table_multi_vessel <- prop.table(count_table_multi_vessel) * 100
result_multi_vessel <- data.frame(
Item = names(count_table_multi_vessel),
Count = as.numeric(count_table_multi_vessel),
Percentage = paste0(round(prop_table_multi_vessel, 1), "%")
)
result_multi_vessel=result_multi_vessel[order(result_multi_vessel$Count,decreasing = TRUE), ]
print(result_multi_vessel)
word_counts <- tibble(text = cwr_tidy$encounter_summary) %>%
unnest_tokens(word, text) %>%
anti_join(stop_words) %>%
count(word, sort = TRUE) %>%
filter(nchar(word) > 2)
word_counts %>%
slice_max(n, n = 10) %>%
ggplot(aes(x = reorder(word, n), y = n)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(title = "Top 10 Frequent Words", x = "Word", y = "Count")
View(result_long_vessel)
View(result_long_vessel)
filtered_df1 <- cwr_tidy[cwr_tidy$encounter_sequence !=1 & !is.na(cwr_tidy$encounter_sequence), ]
View(filtered_df1)
View(filtered_df1)
knitr::opts_chunk$set(echo = TRUE,message = F,warning = F)
# Load the packages.
library(orcas)
library(lubridate)
library(dplyr)
library(tidytext)
library(ggplot2)
theme_set(theme_bw())
data("cwr_tidy",package='orcas')
orcas<-cwr_tidy
head(cwr_tidy$date)
get_season <- function(dates) {
month_num <- month(dates) # 提取月份
case_when(
month_num %in% 3:5 ~ "Spring",
month_num %in% 6:8 ~ "Summer",
month_num %in% 9:11 ~ "Autumn",
month_num %in% c(12,1,2) ~ "Winter",
TRUE ~ NA_character_
) }
seasons=get_season(cwr_tidy$date)
count_table <- table(seasons)
prop_table <- prop.table(count_table) * 100
result <- data.frame(
Item = names(count_table),
Count = as.numeric(count_table),
Percentage = paste0(round(prop_table, 1), "%")
)
print(result)
duration1=c(cwr_tidy$end_time-cwr_tidy$begin_time)
duration1 <- duration1[duration1 >= 0 & !is.na(duration1)]
duration1=data.frame(duration1)
ggplot(duration1,aes(duration1))+
geom_density()
quantile(duration1$duration1)
count_table1 <- table(cwr_tidy$location)
prop_table1 <- prop.table(count_table1) * 100
result1 <- data.frame(
Item = names(count_table1),
Count = as.numeric(count_table1),
Percentage = paste0(round(prop_table1, 1), "%")
)
result1=result1[order(result1$Count,decreasing = TRUE), ]
print(result1)
filtered_df1 <- cwr_tidy[cwr_tidy$encounter_sequence !=1 & !is.na(cwr_tidy$encounter_sequence), ]
count_table_observers <- table(cwr_tidy$observers)
prop_table_observers <- prop.table(count_table_observers) * 100
result_observers <- data.frame(
Item = names(count_table_observers),
Count = as.numeric(count_table_observers),
Percentage = paste0(round(prop_table_observers, 1), "%")
)
result_observers=result_observers[order(result_observers$Count,decreasing = TRUE), ]
print(result_observers)
count_table_vessel <- table(cwr_tidy$vessel)
prop_table_vessel <- prop.table(count_table_vessel) * 100
result_vessel <- data.frame(
Item = names(count_table_vessel),
Count = as.numeric(count_table_vessel),
Percentage = paste0(round(prop_table_vessel, 1), "%")
)
result_vessel=result_vessel[order(result_vessel$Count,decreasing = TRUE), ]
print(result_vessel)
duration1=c(cwr_tidy$end_time-cwr_tidy$begin_time)
duration1 <- duration1[duration1 >= 0 & !is.na(duration1)]
duration1=data.frame(duration1)
ggplot(duration1,aes(duration1))+
geom_density()
cwr_tidy$duration1=cwr_tidy$end_time-cwr_tidy$begin_time
filtered_df <- cwr_tidy[cwr_tidy$duration1 > 10000 & !is.na(cwr_tidy$duration1), ]
count_table_long_vessel <- table(filtered_df$vessel)
prop_table_long_vessel <- prop.table(count_table_long_vessel) * 100
result_long_vessel <- data.frame(
Item = names(count_table_long_vessel),
Count = as.numeric(count_table_long_vessel),
Percentage = paste0(round(prop_table_long_vessel, 1), "%")
)
result_long_vessel=result_long_vessel[order(result_long_vessel$Count,decreasing = TRUE), ]
print(result_long_vessel)
filtered_df1 <- cwr_tidy[cwr_tidy$encounter_sequence !=1 & !is.na(cwr_tidy$encounter_sequence), ]
count_table_multi_vessel <- table(filtered_df1$vessel)
prop_table_multi_vessel <- prop.table(count_table_multi_vessel) * 100
result_multi_vessel <- data.frame(
Item = names(count_table_multi_vessel),
Count = as.numeric(count_table_multi_vessel),
Percentage = paste0(round(prop_table_multi_vessel, 1), "%")
)
result_multi_vessel=result_multi_vessel[order(result_multi_vessel$Count,decreasing = TRUE), ]
print(result_multi_vessel)
word_counts <- tibble(text = cwr_tidy$encounter_summary) %>%
unnest_tokens(word, text) %>%
anti_join(stop_words) %>%
count(word, sort = TRUE) %>%
filter(nchar(word) > 2)
word_counts %>%
slice_max(n, n = 10) %>%
ggplot(aes(x = reorder(word, n), y = n)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(title = "Top 10 Frequent Words", x = "Word", y = "Count")
save.image("C:/Users/yangjun1-jk/Desktop/assign01-submission.RData")
time_range <- range(cwr_tidy$date)
print(time_range)
time_range <- range(cwr_tidy[ !is.na(cwr_tidy$date), ]$date)
print(time_range)
time_range <- range(cwr_tidy[ !is.na(cwr_tidy$date), ]$date)
print(time_range)
install.packages("palmerpenguins")
install.packages("shiny")
library(shiny)
install.packages("shiny")
library(shiny)
library(bslib)
ui <- page_sidebar(
# App title ----
title = "Hello Shiny!",
# Sidebar panel for inputs ----
sidebar = sidebar(
# Input: Slider for the number of bins ----
sliderInput(
inputId = "bins",
label = "Number of bins:",
min = 1,
max = 50,
value = 30
)
),
# Output: Histogram ----
plotOutput(outputId = "distPlot")
)
View(ui)
devtools::install()
setwd("C:/Users/yangjun1-jk/Desktop/ETC5523/YarraWaterAnalysis")
setwd("C:/Users/yangjun1-jk/Desktop/ETC5523/YarraWaterAnalysis")
